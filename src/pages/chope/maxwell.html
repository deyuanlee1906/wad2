<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maxwell Food Center</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="/styles/main.css">
    <link rel="stylesheet" href="/styles/components.css">
    <script type="module" src="/scripts/firebaseauth.js"></script>
    <script src="seatDatabase.js"></script>
    <style>
        :root {
            --space-32: 32px;
            --space-24: 24px;
            --space-20: 20px;
            --space-16: 16px;
            --space-12: 12px;
            --space-8: 8px;
        }

        body {
            padding-top: 70px;
            padding-bottom: 80px;
            overflow-x: hidden;
        }

        @media (max-width: 768px) {
            body {
                padding-top: env(safe-area-inset-top);
                padding-bottom: calc(80px + env(safe-area-inset-bottom));
            }
        }

        .container-fluid {
            max-width: 1400px;
            margin: 0 auto;
            padding: var(--space-24);
        }

        .back-btn {
            margin-bottom: 16px;
            padding: 8px 16px;
            background-color: #f5f5f5;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            cursor: pointer;
            color: #1a1a1a;
            font-weight: 600;
            min-height: 44px;
        }

        .back-btn:hover {
            background-color: #e0e0e0;
        }

        .floor-plan-container {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            margin-bottom: var(--space-24);
        }

        #floorPlan {
            min-width: 100%;
            height: auto;
        }

        @media (max-width: 430px) {
            body {
                padding-top: max(70px, env(safe-area-inset-top));
                padding-bottom: calc(80px + env(safe-area-inset-bottom));
            }

            .container-fluid {
                padding: var(--space-16);
                padding-top: max(var(--space-16), env(safe-area-inset-top));
            }

            h2 {
                font-size: 1.5rem;
                margin-bottom: var(--space-12);
            }

            h5 {
                font-size: 1.1rem;
            }

            .back-btn {
                width: 100%;
                margin-bottom: var(--space-12);
            }

            .floor-plan-container {
                margin-bottom: var(--space-16);
            }

            #floorPlan {
                min-height: 400px;
            }

            .legend-box {
                width: 16px;
                height: 16px;
            }

            .d-flex.justify-content-center {
                flex-wrap: wrap;
                gap: var(--space-8);
            }
        }

        /* iPhone 14 Pro Max specific optimizations (430x932) */
        @media (max-width: 430px) and (min-height: 900px) {
            .container-fluid {
                padding: var(--space-20);
                padding-top: max(var(--space-20), env(safe-area-inset-top));
                padding-bottom: max(var(--space-20), env(safe-area-inset-bottom));
            }

            #floorPlan {
                min-height: 450px;
            }
        }
    </style>
</head>
<body class="theme-gradient">
    <div class="container-fluid px-3">
        <!-- Header with back button -->
        <div class="position-relative mb-3">
            <!-- Back button -->
            <button class="back-btn" onclick="history.back()">
                <i class="bi bi-arrow-left"></i> Back
            </button>
            <!-- Centered header -->
            <h2 class="text-center mb-0 py-2">SEAT PLAN</h2>
        </div>

        <!-- Location title -->
        <h5 class="text-center mb-3">Maxwell Food Centre</h5>

        <!-- Legend -->
        <div class="d-flex justify-content-center align-items-center mb-4">
            <div class="d-flex align-items-center mx-3">
                <div class="legend-box booked-color me-2"></div>
                <span>Booked</span>
            </div>
            <div class="d-flex align-items-center mx-3">
                <div class="legend-box available-color me-2"></div>
                <span>Available</span>
            </div>
            <div class="d-flex align-items-center mx-3">
                <div class="legend-box hawker-color me-2"></div>
                <span>Stall</span>
            </div>
        </div>

        <!-- SVG Floor Plan Container -->
        <div class="floor-plan-container">
            <svg id="floorPlan" viewBox="0 0 800 600" class="w-100">
                <!-- Row 1: 3 Tables -->
                <!-- Table 1 -->
                <rect x="170" y="50" width="100" height="160" fill="#F2D9BB" stroke="#D98566" stroke-width="2" rx="8"/>
                <text x="220" y="140" text-anchor="middle" class="table-label">Table 1</text>
                
                <!-- Table 1 Seats - Left side (6 seats) -->
                <circle cx="150" cy="70" r="8" fill="#28a745" class="seat clickable" data-table="1" data-seat="1" data-status="available"/>
                <text x="150" y="74" text-anchor="middle" class="seat-number">1</text>
                <circle cx="150" cy="90" r="8" fill="#28a745" class="seat clickable" data-table="1" data-seat="2" data-status="available"/>
                <text x="150" y="94" text-anchor="middle" class="seat-number">2</text>
                <circle cx="150" cy="110" r="8" fill="#28a745" class="seat clickable" data-table="1" data-seat="3" data-status="available"/>
                <text x="150" y="114" text-anchor="middle" class="seat-number">3</text>
                <circle cx="150" cy="130" r="8" fill="#28a745" class="seat clickable" data-table="1" data-seat="4" data-status="available"/>
                <text x="150" y="134" text-anchor="middle" class="seat-number">4</text>
                <circle cx="150" cy="150" r="8" fill="#28a745" class="seat clickable" data-table="1" data-seat="5" data-status="available"/>
                <text x="150" y="154" text-anchor="middle" class="seat-number">5</text>
                <circle cx="150" cy="170" r="8" fill="#28a745" class="seat clickable" data-table="1" data-seat="6" data-status="available"/>
                <text x="150" y="174" text-anchor="middle" class="seat-number">6</text>
                
                <!-- Table 1 Seats - Right side (6 seats) -->
                <circle cx="290" cy="70" r="8" fill="#28a745" class="seat clickable" data-table="1" data-seat="7" data-status="available"/>
                <text x="290" y="74" text-anchor="middle" class="seat-number">7</text>
                <circle cx="290" cy="90" r="8" fill="#28a745" class="seat clickable" data-table="1" data-seat="8" data-status="available"/>
                <text x="290" y="94" text-anchor="middle" class="seat-number">8</text>
                <circle cx="290" cy="110" r="8" fill="#28a745" class="seat clickable" data-table="1" data-seat="9" data-status="available"/>
                <text x="290" y="114" text-anchor="middle" class="seat-number">9</text>
                <circle cx="290" cy="130" r="8" fill="#28a745" class="seat clickable" data-table="1" data-seat="10" data-status="available"/>
                <text x="290" y="134" text-anchor="middle" class="seat-number">10</text>
                <circle cx="290" cy="150" r="8" fill="#28a745" class="seat clickable" data-table="1" data-seat="11" data-status="available"/>
                <text x="290" y="154" text-anchor="middle" class="seat-number">11</text>
                <circle cx="290" cy="170" r="8" fill="#28a745" class="seat clickable" data-table="1" data-seat="12" data-status="available"/>
                <text x="290" y="174" text-anchor="middle" class="seat-number">12</text>

                <!-- Table 2 -->
                <rect x="340" y="50" width="100" height="160" fill="#F2D9BB" stroke="#D98566" stroke-width="2" rx="8"/>
                <text x="390" y="140" text-anchor="middle" class="table-label">Table 2</text>
                
                <!-- Table 2 Seats - Left side (6 seats) -->
                <circle cx="320" cy="70" r="8" fill="#28a745" class="seat clickable" data-table="2" data-seat="1" data-status="available"/>
                <text x="320" y="74" text-anchor="middle" class="seat-number">1</text>
                <circle cx="320" cy="90" r="8" fill="#28a745" class="seat clickable" data-table="2" data-seat="2" data-status="available"/>
                <text x="320" y="94" text-anchor="middle" class="seat-number">2</text>
                <circle cx="320" cy="110" r="8" fill="#28a745" class="seat clickable" data-table="2" data-seat="3" data-status="available"/>
                <text x="320" y="114" text-anchor="middle" class="seat-number">3</text>
                <circle cx="320" cy="130" r="8" fill="#28a745" class="seat clickable" data-table="2" data-seat="4" data-status="available"/>
                <text x="320" y="134" text-anchor="middle" class="seat-number">4</text>
                <circle cx="320" cy="150" r="8" fill="#28a745" class="seat clickable" data-table="2" data-seat="5" data-status="available"/>
                <text x="320" y="154" text-anchor="middle" class="seat-number">5</text>
                <circle cx="320" cy="170" r="8" fill="#28a745" class="seat clickable" data-table="2" data-seat="6" data-status="available"/>
                <text x="320" y="174" text-anchor="middle" class="seat-number">6</text>
                
                <!-- Table 2 Seats - Right side (6 seats) -->
                <circle cx="460" cy="70" r="8" fill="#28a745" class="seat clickable" data-table="2" data-seat="7" data-status="available"/>
                <text x="460" y="74" text-anchor="middle" class="seat-number">7</text>
                <circle cx="460" cy="90" r="8" fill="#28a745" class="seat clickable" data-table="2" data-seat="8" data-status="available"/>
                <text x="460" y="94" text-anchor="middle" class="seat-number">8</text>
                <circle cx="460" cy="110" r="8" fill="#28a745" class="seat clickable" data-table="2" data-seat="9" data-status="available"/>
                <text x="460" y="114" text-anchor="middle" class="seat-number">9</text>
                <circle cx="460" cy="130" r="8" fill="#28a745" class="seat clickable" data-table="2" data-seat="10" data-status="available"/>
                <text x="460" y="134" text-anchor="middle" class="seat-number">10</text>
                <circle cx="460" cy="150" r="8" fill="#28a745" class="seat clickable" data-table="2" data-seat="11" data-status="available"/>
                <text x="460" y="154" text-anchor="middle" class="seat-number">11</text>
                <circle cx="460" cy="170" r="8" fill="#28a745" class="seat clickable" data-table="2" data-seat="12" data-status="available"/>
                <text x="460" y="174" text-anchor="middle" class="seat-number">12</text>

                <!-- Table 3 -->
                <rect x="510" y="50" width="100" height="160" fill="#F2D9BB" stroke="#D98566" stroke-width="2" rx="8"/>
                <text x="560" y="140" text-anchor="middle" class="table-label">Table 3</text>
                
                <!-- Table 3 Seats - Left side (6 seats) -->
                <circle cx="490" cy="70" r="8" fill="#28a745" class="seat clickable" data-table="3" data-seat="1" data-status="available"/>
                <text x="490" y="74" text-anchor="middle" class="seat-number">1</text>
                <circle cx="490" cy="90" r="8" fill="#28a745" class="seat clickable" data-table="3" data-seat="2" data-status="available"/>
                <text x="490" y="94" text-anchor="middle" class="seat-number">2</text>
                <circle cx="490" cy="110" r="8" fill="#28a745" class="seat clickable" data-table="3" data-seat="3" data-status="available"/>
                <text x="490" y="114" text-anchor="middle" class="seat-number">3</text>
                <circle cx="490" cy="130" r="8" fill="#28a745" class="seat clickable" data-table="3" data-seat="4" data-status="available"/>
                <text x="490" y="134" text-anchor="middle" class="seat-number">4</text>
                <circle cx="490" cy="150" r="8" fill="#28a745" class="seat clickable" data-table="3" data-seat="5" data-status="available"/>
                <text x="490" y="154" text-anchor="middle" class="seat-number">5</text>
                <circle cx="490" cy="170" r="8" fill="#28a745" class="seat clickable" data-table="3" data-seat="6" data-status="available"/>
                <text x="490" y="174" text-anchor="middle" class="seat-number">6</text>
                
                <!-- Table 3 Seats - Right side (6 seats) -->
                <circle cx="630" cy="70" r="8" fill="#28a745" class="seat clickable" data-table="3" data-seat="7" data-status="available"/>
                <text x="630" y="74" text-anchor="middle" class="seat-number">7</text>
                <circle cx="630" cy="90" r="8" fill="#28a745" class="seat clickable" data-table="3" data-seat="8" data-status="available"/>
                <text x="630" y="94" text-anchor="middle" class="seat-number">8</text>
                <circle cx="630" cy="110" r="8" fill="#28a745" class="seat clickable" data-table="3" data-seat="9" data-status="available"/>
                <text x="630" y="114" text-anchor="middle" class="seat-number">9</text>
                <circle cx="630" cy="130" r="8" fill="#28a745" class="seat clickable" data-table="3" data-seat="10" data-status="available"/>
                <text x="630" y="134" text-anchor="middle" class="seat-number">10</text>
                <circle cx="630" cy="150" r="8" fill="#28a745" class="seat clickable" data-table="3" data-seat="11" data-status="available"/>
                <text x="630" y="154" text-anchor="middle" class="seat-number">11</text>
                <circle cx="630" cy="170" r="8" fill="#28a745" class="seat clickable" data-table="3" data-seat="12" data-status="available"/>
                <text x="630" y="174" text-anchor="middle" class="seat-number">12</text>

                <!-- Row 2: 6 Stores -->
                <rect x="100" y="250" width="90" height="50" fill="#D98566" stroke="#262626" stroke-width="1" rx="5"/>
                <text x="145" text-anchor="middle" class="stall-label">
                    <tspan y="270">Tian Tian</tspan>
                    <tspan x="145"y="290">Chicken Rice</tspan>
                </text>
                
                <rect x="200" y="250" width="90" height="50" fill="#D98566" stroke="#262626" stroke-width="1" rx="5"/>
                <text x="245" y="280" text-anchor="middle" class="stall-label">Peanut Soup</text>
                
                <rect x="300" y="250" width="90" height="50" fill="#D98566" stroke="#262626" stroke-width="1" rx="5"/>
                <text x="345" y="280" text-anchor="middle" class="stall-label">Hajmeer Kwaja</text>

                <rect x="400" y="250" width="90" height="50" fill="#D98566" stroke="#262626" stroke-width="1" rx="5"/>
                <text x="445" y="280" text-anchor="middle" class="stall-label">Ramen Taisho</text>
                
                <rect x="500" y="250" width="90" height="50" fill="#D98566" stroke="#262626" stroke-width="1" rx="5"/>
                <text x="545" y="280" text-anchor="middle" class="stall-label">
                    <tspan y="270">Neapolitan</tspan>
                    <tspan x="545"y="290">Style Pizze</tspan>
                </text>
                
                <rect x="600" y="250" width="90" height="50" fill="#D98566" stroke="#262626" stroke-width="1" rx="5"/>
                <text x="645" y="280" text-anchor="middle" class="stall-label">Korean Cuisine</text>

                <rect x="10" y="100" width="50" height="90" fill="#D98566" stroke="#262626" stroke-width="1" rx="5"/>
                <text x="35" y="150" text-anchor="middle" class="stall-label">
                    <tspan y="130">China</tspan>
                    <tspan x="35"y="150">Street</tspan>
                    <tspan x="35"y="170">Fritters</tspan>
                </text>

                <rect x="10" y="390" width="50" height="90" fill="#D98566" stroke="#262626" stroke-width="1" rx="5"/>
                <text x="35" y="440" text-anchor="middle" class="stall-label">
                    <tspan y="420">Bold</tspan>
                    <tspan x="35"y="440">X</tspan>
                    <tspan x="35"y="460">Braised</tspan>
                </text>

                <!-- Row 3: 3 Tables -->
                <!-- Table 4 -->
                <rect x="170" y="350" width="100" height="160" fill="#F2D9BB" stroke="#D98566" stroke-width="2" rx="8"/>
                <text x="220" y="440" text-anchor="middle" class="table-label">Table 4</text>
                
                <!-- Table 4 Seats - Left side (6 seats) -->
                <circle cx="150" cy="370" r="8" fill="#28a745" class="seat clickable" data-table="4" data-seat="1" data-status="available"/>
                <text x="150" y="374" text-anchor="middle" class="seat-number">1</text>
                <circle cx="150" cy="390" r="8" fill="#28a745" class="seat clickable" data-table="4" data-seat="2" data-status="available"/>
                <text x="150" y="394" text-anchor="middle" class="seat-number">2</text>
                <circle cx="150" cy="410" r="8" fill="#28a745" class="seat clickable" data-table="4" data-seat="3" data-status="available"/>
                <text x="150" y="414" text-anchor="middle" class="seat-number">3</text>
                <circle cx="150" cy="430" r="8" fill="#28a745" class="seat clickable" data-table="4" data-seat="4" data-status="available"/>
                <text x="150" y="434" text-anchor="middle" class="seat-number">4</text>
                <circle cx="150" cy="450" r="8" fill="#28a745" class="seat clickable" data-table="4" data-seat="5" data-status="available"/>
                <text x="150" y="454" text-anchor="middle" class="seat-number">5</text>
                <circle cx="150" cy="470" r="8" fill="#28a745" class="seat clickable" data-table="4" data-seat="6" data-status="available"/>
                <text x="150" y="474" text-anchor="middle" class="seat-number">6</text>
                
                <!-- Table 4 Seats - Right side (6 seats) -->
                <circle cx="290" cy="370" r="8" fill="#28a745" class="seat clickable" data-table="4" data-seat="7" data-status="available"/>
                <text x="290" y="374" text-anchor="middle" class="seat-number">7</text>
                <circle cx="290" cy="390" r="8" fill="#28a745" class="seat clickable" data-table="4" data-seat="8" data-status="available"/>
                <text x="290" y="394" text-anchor="middle" class="seat-number">8</text>
                <circle cx="290" cy="410" r="8" fill="#28a745" class="seat clickable" data-table="4" data-seat="9" data-status="available"/>
                <text x="290" y="414" text-anchor="middle" class="seat-number">9</text>
                <circle cx="290" cy="430" r="8" fill="#28a745" class="seat clickable" data-table="4" data-seat="10" data-status="available"/>
                <text x="290" y="434" text-anchor="middle" class="seat-number">10</text>
                <circle cx="290" cy="450" r="8" fill="#28a745" class="seat clickable" data-table="4" data-seat="11" data-status="available"/>
                <text x="290" y="454" text-anchor="middle" class="seat-number">11</text>
                <circle cx="290" cy="470" r="8" fill="#28a745" class="seat clickable" data-table="4" data-seat="12" data-status="available"/>
                <text x="290" y="474" text-anchor="middle" class="seat-number">12</text>

                <!-- Table 5 -->
                <rect x="340" y="350" width="100" height="160" fill="#F2D9BB" stroke="#D98566" stroke-width="2" rx="8"/>
                <text x="390" y="440" text-anchor="middle" class="table-label">Table 5</text>
                
                <!-- Table 5 Seats - Left side (6 seats) -->
                <circle cx="320" cy="370" r="8" fill="#28a745" class="seat clickable" data-table="5" data-seat="1" data-status="available"/>
                <text x="320" y="374" text-anchor="middle" class="seat-number">1</text>
                <circle cx="320" cy="390" r="8" fill="#28a745" class="seat clickable" data-table="5" data-seat="2" data-status="available"/>
                <text x="320" y="394" text-anchor="middle" class="seat-number">2</text>
                <circle cx="320" cy="410" r="8" fill="#28a745" class="seat clickable" data-table="5" data-seat="3" data-status="available"/>
                <text x="320" y="414" text-anchor="middle" class="seat-number">3</text>
                <circle cx="320" cy="430" r="8" fill="#28a745" class="seat clickable" data-table="5" data-seat="4" data-status="available"/>
                <text x="320" y="434" text-anchor="middle" class="seat-number">4</text>
                <circle cx="320" cy="450" r="8" fill="#28a745" class="seat clickable" data-table="5" data-seat="5" data-status="available"/>
                <text x="320" y="454" text-anchor="middle" class="seat-number">5</text>
                <circle cx="320" cy="470" r="8" fill="#28a745" class="seat clickable" data-table="5" data-seat="6" data-status="available"/>
                <text x="320" y="474" text-anchor="middle" class="seat-number">6</text>
                
                <!-- Table 5 Seats - Right side (6 seats) -->
                <circle cx="460" cy="370" r="8" fill="#28a745" class="seat clickable" data-table="5" data-seat="7" data-status="available"/>
                <text x="460" y="374" text-anchor="middle" class="seat-number">7</text>
                <circle cx="460" cy="390" r="8" fill="#28a745" class="seat clickable" data-table="5" data-seat="8" data-status="available"/>
                <text x="460" y="394" text-anchor="middle" class="seat-number">8</text>
                <circle cx="460" cy="410" r="8" fill="#28a745" class="seat clickable" data-table="5" data-seat="9" data-status="available"/>
                <text x="460" y="414" text-anchor="middle" class="seat-number">9</text>
                <circle cx="460" cy="430" r="8" fill="#28a745" class="seat clickable" data-table="5" data-seat="10" data-status="available"/>
                <text x="460" y="434" text-anchor="middle" class="seat-number">10</text>
                <circle cx="460" cy="450" r="8" fill="#28a745" class="seat clickable" data-table="5" data-seat="11" data-status="available"/>
                <text x="460" y="454" text-anchor="middle" class="seat-number">11</text>
                <circle cx="460" cy="470" r="8" fill="#28a745" class="seat clickable" data-table="5" data-seat="12" data-status="available"/>
                <text x="460" y="474" text-anchor="middle" class="seat-number">12</text>

                <!-- Table 6 -->
                <rect x="510" y="350" width="100" height="160" fill="#F2D9BB" stroke="#D98566" stroke-width="2" rx="8"/>
                <text x="560" y="440" text-anchor="middle" class="table-label">Table 6</text>
                
                <!-- Table 6 Seats - Left side (6 seats) -->
                <circle cx="490" cy="370" r="8" fill="#28a745" class="seat clickable" data-table="6" data-seat="1" data-status="available"/>
                <text x="490" y="374" text-anchor="middle" class="seat-number">1</text>
                <circle cx="490" cy="390" r="8" fill="#28a745" class="seat clickable" data-table="6" data-seat="2" data-status="available"/>
                <text x="490" y="394" text-anchor="middle" class="seat-number">2</text>
                <circle cx="490" cy="410" r="8" fill="#28a745" class="seat clickable" data-table="6" data-seat="3" data-status="available"/>
                <text x="490" y="414" text-anchor="middle" class="seat-number">3</text>
                <circle cx="490" cy="430" r="8" fill="#28a745" class="seat clickable" data-table="6" data-seat="4" data-status="available"/>
                <text x="490" y="434" text-anchor="middle" class="seat-number">4</text>
                <circle cx="490" cy="450" r="8" fill="#28a745" class="seat clickable" data-table="6" data-seat="5" data-status="available"/>
                <text x="490" y="454" text-anchor="middle" class="seat-number">5</text>
                <circle cx="490" cy="470" r="8" fill="#28a745" class="seat clickable" data-table="6" data-seat="6" data-status="available"/>
                <text x="490" y="474" text-anchor="middle" class="seat-number">6</text>
                
                <!-- Table 6 Seats - Right side (6 seats) -->
                <circle cx="630" cy="370" r="8" fill="#28a745" class="seat clickable" data-table="6" data-seat="7" data-status="available"/>
                <text x="630" y="374" text-anchor="middle" class="seat-number">7</text>
                <circle cx="630" cy="390" r="8" fill="#28a745" class="seat clickable" data-table="6" data-seat="8" data-status="available"/>
                <text x="630" y="394" text-anchor="middle" class="seat-number">8</text>
                <circle cx="630" cy="410" r="8" fill="#28a745" class="seat clickable" data-table="6" data-seat="9" data-status="available"/>
                <text x="630" y="414" text-anchor="middle" class="seat-number">9</text>
                <circle cx="630" cy="430" r="8" fill="#28a745" class="seat clickable" data-table="6" data-seat="10" data-status="available"/>
                <text x="630" y="434" text-anchor="middle" class="seat-number">10</text>
                <circle cx="630" cy="450" r="8" fill="#28a745" class="seat clickable" data-table="6" data-seat="11" data-status="available"/>
                <text x="630" y="454" text-anchor="middle" class="seat-number">11</text>
                <circle cx="630" cy="470" r="8" fill="#28a745" class="seat clickable" data-table="6" data-seat="12" data-status="available"/>
                <text x="630" y="474" text-anchor="middle" class="seat-number">12</text>
            </svg>
        </div>

    </div>

    <!-- Booking Modal -->
    <div class="modal fade" id="bookingModal" tabindex="-1" aria-labelledby="bookingModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content custom-modal">
                <div class="modal-header custom-modal-header">
                    <h5 class="modal-title" id="bookingModalLabel">Book Seat</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p id="seatInfo"></p>
                    <p class="text-muted">Confirm your seat booking?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary custom-btn" id="confirmBooking">Book Now</button>
                </div>
            </div>
        </div>
    </div>

    <style>
        /* Custom Color Theme */
        :root {
            --primary-color: #D98566;
            --secondary-color: #F2D9BB;
            --background-color: #F2F2F2;
            --text-color: #262626;
        }

        body {
            background-color: var(--background-color);
        }

        .legend-box {
            width: 12px;
            height: 12px;
            border-radius: 2px;
        }
        
        .booked-color {
            background-color: #dc3545;
        }
        
        .available-color {
            background-color: #28a745;
        }
        
        .hawker-color {
            background-color: var(--primary-color);
        }
        
        .floor-plan-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            width: 100%;
            margin-left: auto;
            margin-right: auto;
             height: auto;
        }

        #floorPlan {
            width: 100%;
            height: auto;
            display: block;
        }
        
        .seat {
            cursor: pointer;
            transition: all 0.15s ease;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
        }
        
        .seat.clickable:hover {
            stroke: var(--text-color);
            stroke-width: 3;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
        }
        
        .seat.booked {
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        .table-label, .stall-label {
            font-size: 12px;
            font-weight: bold;
            fill: var(--text-color);
        }
        
        .seat-number {
            font-size: 8px;
            font-weight: bold;
            fill: white;
            pointer-events: none;
        }
        
        

        /* Modal Styling */
        .custom-modal {
            border-radius: 15px;
            border: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .custom-modal-header {
            background-color: var(--secondary-color);
            border-bottom: 2px solid var(--primary-color);
            border-radius: 15px 15px 0 0;
        }

        .custom-btn {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            border-radius: 8px;
            padding: 8px 20px;
            font-weight: 600;
        }

        .custom-btn:hover {
            background-color: var(--text-color);
            border-color: var(--text-color);
        }

        /* Responsive Design (@media) */
        /* Desktop styles */
        @media (min-width: 992px) {
            .floor-plan-container {
                max-width: 900px;
            }
        }

        /* Tablet and mobile styles */
        @media (max-width: 991px) {
            .floor-plan-container {
                padding: 15px;
                margin: 0 0 20px 0;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch; /* make the comtainer scrollable */
            }
            
            .legend-box {
                width: 10px;
                height: 10px;
            }

            #floorPlan {
                min-width: 800px;
                transform: scale(0.85); /* scale the element to 85% (zoom in) */
                transform-origin: center; /* when scalling, it will shrink/grow from its center */
            }
        }

        /* Mobile specific styles */
        @media (max-width: 575px) {
            .floor-plan-container {
                padding: 10px;
                max-height: 400px;
            }

            #floorPlan {
                transform: scale(0.55); /* scale the element to 60% (zoom in) */
                min-width: 1200px;
                transform-origin: center;
                margin: -50px -100px; /* Adjust positioning to center the zoomed out content */
            }
        }
    </style>

    <script>
        let selectedSeat = null;
        let bookingModal = null;

        // Seat booking functionality
        document.addEventListener('DOMContentLoaded', function() {
            const seats = document.querySelectorAll('.seat');
            bookingModal = new bootstrap.Modal(document.getElementById('bookingModal'));
            
            // Load seat status from database (wait for Firebase)
            loadSeatStatus();
            
            seats.forEach(seat => {
                seat.addEventListener('click', function() {
                    const status = this.getAttribute('data-status');
                    const table = this.getAttribute('data-table');
                    const seatNum = this.getAttribute('data-seat');
                    
                    if (status === 'available') {
                        selectedSeat = {
                            element: this,
                            table: table,
                            seat: seatNum,
                            status: status
                        };
                        
                        // Show booking modal
                        document.getElementById('seatInfo').textContent = 
                            `Table ${table}, Seat ${seatNum} - Maxwell Food Centre`;
                        bookingModal.show();
                    } else if (status === 'booked') {
                        alert('This seat is already booked!');
                    }
                });
            });
            
            // Confirm booking button
            document.getElementById('confirmBooking').addEventListener('click', async function() {
                if (selectedSeat) {
                    const params = new URLSearchParams(window.location.search);
                    // Prefer chope selections saved in sessionStorage, then URL params, then sensible defaults
                    const chopeTime = sessionStorage.getItem('chope_time');
                    const chopeDuration = sessionStorage.getItem('chope_duration');
                    const durationRaw = chopeDuration || params.get("duration");
                    const durationMinutes = (typeof durationRaw === 'string' && durationRaw.includes('hour')) ? 
                        parseInt(durationRaw) * 60 : parseInt(durationRaw);
                    
                    // Book the seat in database
                    const success = await window.seatDatabase.bookSeat('maxwell', selectedSeat.table, selectedSeat.seat, durationMinutes);
                    
                    if (success) {
                        // Update visual status
                        selectedSeat.element.setAttribute('data-status', 'booked');
                        selectedSeat.element.setAttribute('fill', '#dc3545');
                        selectedSeat.element.classList.remove('clickable');
                        selectedSeat.element.classList.add('booked');
                        
                        // Close modal
                        bookingModal.hide();
                        
                        // Resolve time to save/forward
                        const time = chopeTime || params.get("time");
                        
                        const confirmationUrl = `booking-confirmation.html?foodCenter=Maxwell Food Centre&table=${selectedSeat.table}&seat=${selectedSeat.seat}&time=${encodeURIComponent(time)}&duration=${encodeURIComponent(durationRaw)}`;
                        try {
                            // save a dedicated booking snapshot (avoid overwriting chope_* used elsewhere)
                            sessionStorage.setItem('booking_foodCenter', 'Maxwell Food Centre');
                            sessionStorage.setItem('booking_table', selectedSeat.table);
                            sessionStorage.setItem('booking_seat', selectedSeat.seat);
                            sessionStorage.setItem('booking_time', time);
                            sessionStorage.setItem('booking_duration', durationRaw);
                        } catch (e) {
                            console.warn('Could not write booking info to sessionStorage', e);
                        }
                        // include booking details in query string as well
                        const confUrl = confirmationUrl + '&_cached=1';
                        window.location.href = confUrl;
                    } else {
                        alert('Failed to book seat. Please try again.');
                    }
                }
            });
            
        });
        
        async function loadSeatStatus() {
            // Wait for Firebase to be ready
            if (window.seatDatabase && window.seatDatabase.initPromise) {
                await window.seatDatabase.initPromise;
            }
            
            // Refresh data from Firebase
            if (window.seatDatabase && window.seatDatabase.refresh) {
                await window.seatDatabase.refresh();
            }
            
            // Load seat status from database
            const seats = document.querySelectorAll('.seat');
            seats.forEach(seat => {
                const table = seat.getAttribute('data-table');
                const seatNum = seat.getAttribute('data-seat');
                
                const status = window.seatDatabase.getSeatStatus('maxwell', table, seatNum);
                
                if (status === 'booked') {
                    seat.setAttribute('data-status', 'booked');
                    seat.setAttribute('fill', '#dc3545');
                    seat.classList.remove('clickable');
                    seat.classList.add('booked');
                } else {
                    seat.setAttribute('data-status', 'available');
                    seat.setAttribute('fill', '#28a745');
                    seat.classList.add('clickable');
                    seat.classList.remove('booked');
                }
            });
        }
        
        // Refresh seat status every 5 seconds
        setInterval(loadSeatStatus, 5000);

        
        // Adjust seat sizes based on screen size
        function adjustSeatSizes() {
            // get the seats and the seat number
            const seats = document.querySelectorAll('.seat');
            const seatNumbers = document.querySelectorAll('.seat-number');
            
            if (window.innerWidth <= 575) { // Mobile
                seats.forEach(seat => {
                    seat.setAttribute('r', '9'); // set the raduis to 9 (for the svg grafics up there)
                });
                seatNumbers.forEach(num => {
                    num.style.fontSize = '9px';
                });
            } else if (window.innerWidth <= 991) { // Tablet
                seats.forEach(seat => {
                    seat.setAttribute('r', '8');
                });
                seatNumbers.forEach(num => {
                    num.style.fontSize = '8px';
                });
            } else { // Desktop - original size
                seats.forEach(seat => {
                    seat.setAttribute('r', '8');
                });
                seatNumbers.forEach(num => {
                    num.style.fontSize = '8px';
                });
            }
        }

        // Run on load and resize
        window.addEventListener('load', adjustSeatSizes);
        window.addEventListener('resize', adjustSeatSizes);
    </script>

    <!-------------------------Bootstrap------------------------- -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
        crossorigin="anonymous"></script>

    <div class="nav-bar">
      <a href="/" class="nav-logo"><img src="/img/logo.jpg" alt="ChopeLah" /></a>
      <div class="nav-items">
        <button onclick="location.href='../order/online-order-home.html'">
          <i class="bi bi-cart3"></i>
          <span>Order</span>
        </button>
        <button onclick="location.href='../community/community.html'">
          <i class="bi bi-people"></i>
          <span>Community</span>
        </button>
        <button class="active" onclick="location.href='chope.html'">
          <i class="bi bi-bookmark"></i>
          <span>Chope</span>
        </button>
        <button onclick="location.href='../crowd/crowd-view.html'">
          <i class="bi bi-eye"></i>
          <span>Crowd View</span>
        </button>
      </div>
      <div class="nav-right">
        <button class="notification-btn" onclick="alert('No new notifications')">
          <i class="bi bi-bell"></i>
          <span class="notification-badge">3</span>
        </button>
        <button onclick="location.href='../profile/profile.html'">
          <i class="bi bi-person"></i>
          <span>Profile</span>
        </button>
      </div>
    </div>
</body>
</html>