<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Newton Food Center</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="/styles/main.css">
    <link rel="stylesheet" href="/styles/components.css">
    <script type="module" src="/scripts/firebaseauth.js"></script>
    <script src="seatDatabase.js"></script>
    <style>
        .back-btn {
            margin-bottom: 16px;
            padding: 8px 16px;
            background-color: #f5f5f5;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            cursor: pointer;
            color: #1a1a1a;
            font-weight: 600;
        }

        .back-btn:hover {
            background-color: #e0e0e0;
        }
    </style>
</head>
<body>
    <div class="container-fluid px-3">
        <!-- Header with back button -->
        <div class="position-relative mb-3">
            <!-- Back button -->
            <button class="back-btn" onclick="history.back()">
                <i class="bi bi-arrow-left"></i> Back
            </button>
            <!-- Centered header -->
            <h2 class="text-center mb-0 py-2">SEAT PLAN</h2>
        </div>

        <!-- Location title -->
        <h5 class="text-center mb-3">Newton Food Centre</h5>

        <!-- Legend -->
        <div class="d-flex justify-content-center align-items-center mb-4">
            <div class="d-flex align-items-center mx-3">
                <div class="legend-box booked-color me-2"></div>
                <span>Booked</span>
            </div>
            <div class="d-flex align-items-center mx-3">
                <div class="legend-box available-color me-2"></div>
                <span>Available</span>
            </div>
            <div class="d-flex align-items-center mx-3">
                <div class="legend-box hawker-color me-2"></div>
                <span>Stall</span>
            </div>
        </div>

        <!-- SVG Floor Plan Container -->
        <div class="floor-plan-container">
            <svg id="floorPlan" viewBox="0 0 800 600" class="w-100">
                <!-- Row 1: 3 Tables (10 seats each) -->
                <!-- Table 1 -->
                <rect x="50" y="180" width="100" height="140" fill="#F2D9BB" stroke="#D98566" stroke-width="2" rx="8"/>
                <text x="100" y="260" text-anchor="middle" class="table-label">Table 1</text>
                
                <!-- Table 1 Seats - Left side (5 seats) -->
                <circle cx="30" cy="200" r="8" fill="#28a745" class="seat clickable" data-table="1" data-seat="1" data-status="available"/>
                <text x="30" y="204" text-anchor="middle" class="seat-number">1</text>
                <circle cx="30" cy="220" r="8" fill="#28a745" class="seat clickable" data-table="1" data-seat="2" data-status="available"/>
                <text x="30" y="224" text-anchor="middle" class="seat-number">2</text>
                <circle cx="30" cy="240" r="8" fill="#28a745" class="seat clickable" data-table="1" data-seat="3" data-status="available"/>
                <text x="30" y="244" text-anchor="middle" class="seat-number">3</text>
                <circle cx="30" cy="260" r="8" fill="#28a745" class="seat clickable" data-table="1" data-seat="4" data-status="available"/>
                <text x="30" y="264" text-anchor="middle" class="seat-number">4</text>
                <circle cx="30" cy="280" r="8" fill="#28a745" class="seat clickable" data-table="1" data-seat="5" data-status="available"/>
                <text x="30" y="284" text-anchor="middle" class="seat-number">5</text>
                
                <!-- Table 1 Seats - Right side (5 seats) -->
                <circle cx="170" cy="200" r="8" fill="#28a745" class="seat clickable" data-table="1" data-seat="6" data-status="available"/>
                <text x="170" y="204" text-anchor="middle" class="seat-number">6</text>
                <circle cx="170" cy="220" r="8" fill="#28a745" class="seat clickable" data-table="1" data-seat="7" data-status="available"/>
                <text x="170" y="224" text-anchor="middle" class="seat-number">7</text>
                <circle cx="170" cy="240" r="8" fill="#28a745" class="seat clickable" data-table="1" data-seat="8" data-status="available"/>
                <text x="170" y="244" text-anchor="middle" class="seat-number">8</text>
                <circle cx="170" cy="260" r="8" fill="#28a745" class="seat clickable" data-table="1" data-seat="9" data-status="available"/>
                <text x="170" y="264" text-anchor="middle" class="seat-number">9</text>
                <circle cx="170" cy="280" r="8" fill="#28a745" class="seat clickable" data-table="1" data-seat="10" data-status="available"/>
                <text x="170" y="284" text-anchor="middle" class="seat-number">10</text>

                <!-- Table 2 -->
                <rect x="270" y="50" width="100" height="140" fill="#F2D9BB" stroke="#D98566" stroke-width="2" rx="8"/>
                <text x="320" y="130" text-anchor="middle" class="table-label">Table 2</text>
                
                <!-- Table 2 Seats - Left side (5 seats) -->
                <circle cx="250" cy="70" r="8" fill="#28a745" class="seat clickable" data-table="2" data-seat="1" data-status="available"/>
                <text x="250" y="74" text-anchor="middle" class="seat-number">1</text>
                <circle cx="250" cy="90" r="8" fill="#28a745" class="seat clickable" data-table="2" data-seat="2" data-status="available"/>
                <text x="250" y="94" text-anchor="middle" class="seat-number">2</text>
                <circle cx="250" cy="110" r="8" fill="#28a745" class="seat clickable" data-table="2" data-seat="3" data-status="available"/>
                <text x="250" y="114" text-anchor="middle" class="seat-number">3</text>
                <circle cx="250" cy="130" r="8" fill="#28a745" class="seat clickable" data-table="2" data-seat="4" data-status="available"/>
                <text x="250" y="134" text-anchor="middle" class="seat-number">4</text>
                <circle cx="250" cy="150" r="8" fill="#28a745" class="seat clickable" data-table="2" data-seat="5" data-status="available"/>
                <text x="250" y="154" text-anchor="middle" class="seat-number">5</text>
                
                <!-- Table 2 Seats - Right side (5 seats) -->
                <circle cx="390" cy="70" r="8" fill="#28a745" class="seat clickable" data-table="2" data-seat="6" data-status="available"/>
                <text x="390" y="74" text-anchor="middle" class="seat-number">6</text>
                <circle cx="390" cy="90" r="8" fill="#28a745" class="seat clickable" data-table="2" data-seat="7" data-status="available"/>
                <text x="390" y="94" text-anchor="middle" class="seat-number">7</text>
                <circle cx="390" cy="110" r="8" fill="#28a745" class="seat clickable" data-table="2" data-seat="8" data-status="available"/>
                <text x="390" y="114" text-anchor="middle" class="seat-number">8</text>
                <circle cx="390" cy="130" r="8" fill="#28a745" class="seat clickable" data-table="2" data-seat="9" data-status="available"/>
                <text x="390" y="134" text-anchor="middle" class="seat-number">9</text>
                <circle cx="390" cy="150" r="8" fill="#28a745" class="seat clickable" data-table="2" data-seat="10" data-status="available"/>
                <text x="390" y="154" text-anchor="middle" class="seat-number">10</text>

                <!-- Table 3 -->
                <rect x="440" y="50" width="100" height="140" fill="#F2D9BB" stroke="#D98566" stroke-width="2" rx="8"/>
                <text x="490" y="130" text-anchor="middle" class="table-label">Table 3</text>
                
                <!-- Table 3 Seats - Left side (5 seats) -->
                <circle cx="420" cy="70" r="8" fill="#28a745" class="seat clickable" data-table="3" data-seat="1" data-status="available"/>
                <text x="420" y="74" text-anchor="middle" class="seat-number">1</text>
                <circle cx="420" cy="90" r="8" fill="#28a745" class="seat clickable" data-table="3" data-seat="2" data-status="available"/>
                <text x="420" y="94" text-anchor="middle" class="seat-number">2</text>
                <circle cx="420" cy="110" r="8" fill="#28a745" class="seat clickable" data-table="3" data-seat="3" data-status="available"/>
                <text x="420" y="114" text-anchor="middle" class="seat-number">3</text>
                <circle cx="420" cy="130" r="8" fill="#28a745" class="seat clickable" data-table="3" data-seat="4" data-status="available"/>
                <text x="420" y="134" text-anchor="middle" class="seat-number">4</text>
                <circle cx="420" cy="150" r="8" fill="#28a745" class="seat clickable" data-table="3" data-seat="5" data-status="available"/>
                <text x="420" y="154" text-anchor="middle" class="seat-number">5</text>
                
                <!-- Table 3 Seats - Right side (5 seats) -->
                <circle cx="560" cy="70" r="8" fill="#28a745" class="seat clickable" data-table="3" data-seat="6" data-status="available"/>
                <text x="560" y="74" text-anchor="middle" class="seat-number">6</text>
                <circle cx="560" cy="90" r="8" fill="#28a745" class="seat clickable" data-table="3" data-seat="7" data-status="available"/>
                <text x="560" y="94" text-anchor="middle" class="seat-number">7</text>
                <circle cx="560" cy="110" r="8" fill="#28a745" class="seat clickable" data-table="3" data-seat="8" data-status="available"/>
                <text x="560" y="114" text-anchor="middle" class="seat-number">8</text>
                <circle cx="560" cy="130" r="8" fill="#28a745" class="seat clickable" data-table="3" data-seat="9" data-status="available"/>
                <text x="560" y="134" text-anchor="middle" class="seat-number">9</text>
                <circle cx="560" cy="150" r="8" fill="#28a745" class="seat clickable" data-table="3" data-seat="10" data-status="available"/>
                <text x="560" y="154" text-anchor="middle" class="seat-number">10</text>

                <!-- Row 2: 4 Stores -->
                <rect x="220" y="220" width="90" height="50" fill="#D98566" stroke="#262626" stroke-width="1" rx="5"/>
                <text x="265" y="250" text-anchor="middle" class="stall-label">
                    <tspan y="240">Hotpot BBQ</tspan>
                    <tspan x="265" y="260">Seafood</tspan>
                </text>
                
                <rect x="320" y="220" width="90" height="50" fill="#D98566" stroke="#262626" stroke-width="1" rx="5"/>
                <text x="365" y="250" text-anchor="middle" class="stall-label">
                    <tspan y="240">22</tspan>
                    <tspan x="365" y="260">Best Satay</tspan>
                </text>
                
                <rect x="420" y="220" width="90" height="50" fill="#D98566" stroke="#262626" stroke-width="1" rx="5"/>
                <text x="465" y="250" text-anchor="middle" class="stall-label">
                    <tspan y="240">Heng Heng</tspan>
                    <tspan x="465" y="260">Chicken Rice</tspan>
                </text>
                
                <rect x="520" y="220" width="90" height="50" fill="#D98566" stroke="#262626" stroke-width="1" rx="5"/>
                <text x="565" y="250" text-anchor="middle" class="stall-label">
                    <tspan y="240">Teochew Rice</tspan>
                    <tspan x="565" y="260">And Porridge</tspan>
                </text>

                <rect x="680" y="90" width="50" height="90" fill="#D98566" stroke="#262626" stroke-width="1" rx="5"/>
                <text x="705" y="140" text-anchor="middle" class="stall-label">
                    <tspan y="120">Lina</tspan>
                    <tspan x="705" y="140">Fishball</tspan>
                    <tspan x="705" y="160">Noodles</tspan>
                </text>

                <rect x="680" y="360" width="55" height="90" fill="#D98566" stroke="#262626" stroke-width="1" rx="5"/>
                <text x="705" y="410" text-anchor="middle" class="stall-label">
                    <tspan x="708" y="400">Aminah's</tspan>
                    <tspan x="705" y="420">Prata</tspan>
                </text>

                <!-- Row 3: 2 Tables (10 seats each) -->
                <!-- Table 4 -->
                <rect x="270" y="320" width="100" height="140" fill="#F2D9BB" stroke="#D98566" stroke-width="2" rx="8"/>
                <text x="320" y="400" text-anchor="middle" class="table-label">Table 4</text>
                
                <!-- Table 4 Seats - Left side (5 seats) -->
                <circle cx="250" cy="340" r="8" fill="#28a745" class="seat clickable" data-table="4" data-seat="1" data-status="available"/>
                <text x="250" y="344" text-anchor="middle" class="seat-number">1</text>
                <circle cx="250" cy="360" r="8" fill="#28a745" class="seat clickable" data-table="4" data-seat="2" data-status="available"/>
                <text x="250" y="364" text-anchor="middle" class="seat-number">2</text>
                <circle cx="250" cy="380" r="8" fill="#28a745" class="seat clickable" data-table="4" data-seat="3" data-status="available"/>
                <text x="250" y="384" text-anchor="middle" class="seat-number">3</text>
                <circle cx="250" cy="400" r="8" fill="#28a745" class="seat clickable" data-table="4" data-seat="4" data-status="available"/>
                <text x="250" y="404" text-anchor="middle" class="seat-number">4</text>
                <circle cx="250" cy="420" r="8" fill="#28a745" class="seat clickable" data-table="4" data-seat="5" data-status="available"/>
                <text x="250" y="424" text-anchor="middle" class="seat-number">5</text>
                
                <!-- Table 4 Seats - Right side (5 seats) -->
                <circle cx="390" cy="340" r="8" fill="#28a745" class="seat clickable" data-table="4" data-seat="6" data-status="available"/>
                <text x="390" y="344" text-anchor="middle" class="seat-number">6</text>
                <circle cx="390" cy="360" r="8" fill="#28a745" class="seat clickable" data-table="4" data-seat="7" data-status="available"/>
                <text x="390" y="364" text-anchor="middle" class="seat-number">7</text>
                <circle cx="390" cy="380" r="8" fill="#28a745" class="seat clickable" data-table="4" data-seat="8" data-status="available"/>
                <text x="390" y="384" text-anchor="middle" class="seat-number">8</text>
                <circle cx="390" cy="400" r="8" fill="#28a745" class="seat clickable" data-table="4" data-seat="9" data-status="available"/>
                <text x="390" y="404" text-anchor="middle" class="seat-number">9</text>
                <circle cx="390" cy="420" r="8" fill="#28a745" class="seat clickable" data-table="4" data-seat="10" data-status="available"/>
                <text x="390" y="424" text-anchor="middle" class="seat-number">10</text>

                <!-- Table 5 -->
                <rect x="440" y="320" width="100" height="140" fill="#F2D9BB" stroke="#D98566" stroke-width="2" rx="8"/>
                <text x="490" y="400" text-anchor="middle" class="table-label">Table 5</text>
                
                <!-- Table 5 Seats - Left side (5 seats) -->
                <circle cx="420" cy="340" r="8" fill="#28a745" class="seat clickable" data-table="5" data-seat="1" data-status="available"/>
                <text x="420" y="344" text-anchor="middle" class="seat-number">1</text>
                <circle cx="420" cy="360" r="8" fill="#28a745" class="seat clickable" data-table="5" data-seat="2" data-status="available"/>
                <text x="420" y="364" text-anchor="middle" class="seat-number">2</text>
                <circle cx="420" cy="380" r="8" fill="#28a745" class="seat clickable" data-table="5" data-seat="3" data-status="available"/>
                <text x="420" y="384" text-anchor="middle" class="seat-number">3</text>
                <circle cx="420" cy="400" r="8" fill="#28a745" class="seat clickable" data-table="5" data-seat="4" data-status="available"/>
                <text x="420" y="404" text-anchor="middle" class="seat-number">4</text>
                <circle cx="420" cy="420" r="8" fill="#28a745" class="seat clickable" data-table="5" data-seat="5" data-status="available"/>
                <text x="420" y="424" text-anchor="middle" class="seat-number">5</text>
                
                <!-- Table 5 Seats - Right side (5 seats) -->
                <circle cx="560" cy="340" r="8" fill="#28a745" class="seat clickable" data-table="5" data-seat="6" data-status="available"/>
                <text x="560" y="344" text-anchor="middle" class="seat-number">6</text>
                <circle cx="560" cy="360" r="8" fill="#28a745" class="seat clickable" data-table="5" data-seat="7" data-status="available"/>
                <text x="560" y="364" text-anchor="middle" class="seat-number">7</text>
                <circle cx="560" cy="380" r="8" fill="#28a745" class="seat clickable" data-table="5" data-seat="8" data-status="available"/>
                <text x="560" y="384" text-anchor="middle" class="seat-number">8</text>
                <circle cx="560" cy="400" r="8" fill="#28a745" class="seat clickable" data-table="5" data-seat="9" data-status="available"/>
                <text x="560" y="404" text-anchor="middle" class="seat-number">9</text>
                <circle cx="560" cy="420" r="8" fill="#28a745" class="seat clickable" data-table="5" data-seat="10" data-status="available"/>
                <text x="560" y="424" text-anchor="middle" class="seat-number">10</text>
            </svg>
        </div>

        
    </div>

    <!-- Booking Modal -->
    <div class="modal fade" id="bookingModal" tabindex="-1" aria-labelledby="bookingModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content custom-modal">
                <div class="modal-header custom-modal-header">
                    <h5 class="modal-title" id="bookingModalLabel">Book Seat</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p id="seatInfo"></p>
                    <p class="text-muted">Confirm your seat booking?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary custom-btn" id="confirmBooking">Book Now</button>
                </div>
            </div>
        </div>
    </div>

    <style>
        /* Custom Color Theme */
        :root {
            --primary-color: #D98566;
            --secondary-color: #F2D9BB;
            --background-color: #F2F2F2;
            --text-color: #262626;
        }

        body {
            background-color: var(--background-color);
        }

        .legend-box {
            width: 12px;
            height: 12px;
            border-radius: 2px;
        }
        
        .booked-color {
            background-color: #dc3545;
        }
        
        .available-color {
            background-color: #28a745;
        }
        
        .hawker-color {
            background-color: var(--primary-color);
        }
        
        .floor-plan-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            width: 100%;
            margin-left: auto;
            margin-right: auto;
            height: auto;
        }

        #floorPlan {
            width: 100%;
            height: auto;
            display: block;
        }
        
        .seat {
            cursor: pointer;
            transition: all 0.15s ease;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
        }
        
        .seat.clickable:hover {
            stroke: var(--text-color);
            stroke-width: 3;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
        }
        
        .seat.booked {
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        .table-label, .stall-label {
            font-size: 12px;
            font-weight: bold;
            fill: var(--text-color);
        }
        
        .seat-number {
            font-size: 8px;
            font-weight: bold;
            fill: white;
            pointer-events: none;
        }
        

        /* Modal Styling */
        .custom-modal {
            border-radius: 15px;
            border: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .custom-modal-header {
            background-color: var(--secondary-color);
            border-bottom: 2px solid var(--primary-color);
            border-radius: 15px 15px 0 0;
        }

        .custom-btn {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            border-radius: 8px;
            padding: 8px 20px;
            font-weight: 600;
        }

        .custom-btn:hover {
            background-color: var(--text-color);
            border-color: var(--text-color);
        }

        /* Responsive Design (@media) */
        /* Desktop styles */
        @media (min-width: 992px) {
            .floor-plan-container {
                max-width: 900px;
            }
        }

        /* Tablet and mobile styles */
        @media (max-width: 991px) {
            .floor-plan-container {
                padding: 15px;
                margin: 0 0 20px 0;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch; /* make the comtainer scrollable */
            } 
            
            .legend-box {
                width: 10px;
                height: 10px;
            }
            
            #floorPlan {
                min-width: 800px;
                transform: scale(0.85); /* scale the element to 85% (zoom in) */
                transform-origin: center; /* when scalling, it will shrink/grow from its center */
            }
        }

        /* Mobile specific styles */
        @media (max-width: 575px) {
            .floor-plan-container {
                padding: 10px;
                max-height: 400px;
            }

            #floorPlan {
                transform: scale(0.60); /* scale the element to 60% (zoom in) */
                min-width: 1200px;
                transform-origin: center;
                margin: -50px -100px; /* Adjust positioning to center the zoomed out content */
            }
        }
    </style>

    <script>
        let selectedSeat = null;
        let bookingModal = null;

        // Seat booking functionality
        document.addEventListener('DOMContentLoaded', function() {
            const seats = document.querySelectorAll('.seat');
            bookingModal = new bootstrap.Modal(document.getElementById('bookingModal'));
            
            // Load seat status from database (wait for Firebase)
            loadSeatStatus();
            
            seats.forEach(seat => {
                seat.addEventListener('click', function() {
                    const status = this.getAttribute('data-status');
                    const table = this.getAttribute('data-table');
                    const seatNum = this.getAttribute('data-seat');
                    
                    if (status === 'available') {
                        selectedSeat = {
                            element: this,
                            table: table,
                            seat: seatNum,
                            status: status
                        };
                        
                        // Show booking modal
                        document.getElementById('seatInfo').textContent = 
                            `Table ${table}, Seat ${seatNum} - Newton Food Centre`;
                        bookingModal.show();
                    } else if (status === 'booked') {
                        alert('This seat is already booked!');
                    }
                });
            });
            
            // Confirm booking button
            document.getElementById('confirmBooking').addEventListener('click', async function() {
                if (selectedSeat) {
                    const params = new URLSearchParams(window.location.search);
                    // Prefer chope selections saved in sessionStorage, then URL params, then sensible defaults
                    const chopeTime = sessionStorage.getItem('chope_time');
                    const chopeDuration = sessionStorage.getItem('chope_duration');
                    const durationRaw = chopeDuration || params.get("duration");
                    const durationMinutes = (typeof durationRaw === 'string' && durationRaw.includes('hour')) ? 
                        parseInt(durationRaw) * 60 : parseInt(durationRaw);
                    
                    // Book the seat in database
                    const success = await window.seatDatabase.bookSeat('newton', selectedSeat.table, selectedSeat.seat, durationMinutes);
                    
                    if (success) {
                        // Update visual status
                        selectedSeat.element.setAttribute('data-status', 'booked');
                        selectedSeat.element.setAttribute('fill', '#dc3545');
                        selectedSeat.element.classList.remove('clickable');
                        selectedSeat.element.classList.add('booked');
                        
                        // Close modal
                        bookingModal.hide();
                        
                        // Resolve time to save/forward
                        const time = chopeTime || params.get("time");
                        
                        const confirmationUrl = `booking-confirmation.html?foodCenter=Newton Food Centre&table=${selectedSeat.table}&seat=${selectedSeat.seat}&time=${encodeURIComponent(time)}&duration=${encodeURIComponent(durationRaw)}`;
                        try {
                            sessionStorage.setItem('booking_foodCenter', 'Newton Food Centre');
                            sessionStorage.setItem('booking_table', selectedSeat.table);
                            sessionStorage.setItem('booking_seat', selectedSeat.seat);
                            sessionStorage.setItem('booking_time', time);
                            sessionStorage.setItem('booking_duration', durationRaw);
                        } catch (e) {
                            console.warn('Could not write booking info to sessionStorage', e);
                        }
                        const confUrl = confirmationUrl + '&_cached=1';
                        window.location.href = confUrl;
                    } else {
                        alert('Failed to book seat. Please try again.');
                    }
                }
            });
            
        });
        
        async function loadSeatStatus() {
            // Wait for Firebase to be ready
            if (window.seatDatabase && window.seatDatabase.initPromise) {
                await window.seatDatabase.initPromise;
            }
            
            // Refresh data from Firebase
            if (window.seatDatabase && window.seatDatabase.refresh) {
                await window.seatDatabase.refresh();
            }
            
            // Load seat status from database
            const seats = document.querySelectorAll('.seat');
            seats.forEach(seat => {
                const table = seat.getAttribute('data-table');
                const seatNum = seat.getAttribute('data-seat');
                
                const status = window.seatDatabase.getSeatStatus('newton', table, seatNum);
                
                if (status === 'booked') {
                    seat.setAttribute('data-status', 'booked');
                    seat.setAttribute('fill', '#dc3545');
                    seat.classList.remove('clickable');
                    seat.classList.add('booked');
                } else {
                    seat.setAttribute('data-status', 'available');
                    seat.setAttribute('fill', '#28a745');
                    seat.classList.add('clickable');
                    seat.classList.remove('booked');
                }
            });
        }
        
        // Refresh seat status every 5 seconds
        setInterval(loadSeatStatus, 5000);
        
        // Adjust seat sizes based on screen size
        function adjustSeatSizes() {
            // get the seats and the seat number
            const seats = document.querySelectorAll('.seat');
            const seatNumbers = document.querySelectorAll('.seat-number');
            
            if (window.innerWidth <= 575) { // Mobile
                seats.forEach(seat => {
                    seat.setAttribute('r', '9'); // set the raduis to 9 (for the svg grafics up there)
                });
                seatNumbers.forEach(num => {
                    num.style.fontSize = '9px';
                });
            } else if (window.innerWidth <= 991) { // Tablet
                seats.forEach(seat => {
                    seat.setAttribute('r', '8');
                });
                seatNumbers.forEach(num => {
                    num.style.fontSize = '8px';
                });
            } else { // Desktop - original size
                seats.forEach(seat => {
                    seat.setAttribute('r', '8');
                });
                seatNumbers.forEach(num => {
                    num.style.fontSize = '8px';
                });
            }
        }

        // Run on load and resize
        window.addEventListener('load', adjustSeatSizes);
        window.addEventListener('resize', adjustSeatSizes);
    </script>

    <!-------------------------Bootstrap------------------------- -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
        crossorigin="anonymous"></script>

</body>
</html>